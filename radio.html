<!DOCTYPE html>
<html lang="my">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>FM Radio autoDJ Playlist with Video</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Moulpali&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');

  /* Reset & base */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: 'Moulpali', 'Montserrat', sans-serif;
    background: linear-gradient(135deg, #1e3c72, #2a5298);
    color: #f0f0f0;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  header {
    padding: 1rem 1.5rem;
    width: 100%;
    max-width: 350px;
    background: rgba(0, 0, 0, 0.5);
    border-bottom: 3px solid #ff3377;
    text-align: center;
    user-select: none;
  }
  header h1 {
    margin: 0;
    font-weight: 700;
    font-size: 1.6rem;
    letter-spacing: 2px;
    color: #ff66aa;
  }
  header p {
    margin: 0.3rem 0 0 0;
    font-weight: 400;
    font-size: 0.95rem;
    color: #ffa0c9;
  }

  main {
    flex-grow: 1;
    width: 100%;
    max-width: 350px;
    padding: 1rem 1rem 1.5rem;
    display: flex;
    flex-direction: column;
    background: rgba(0,0,0,0.35);
    border-radius: 12px;
    margin-top: 1rem;
  }
  
  /* Video container */
  #video-container {
    width: 100%;
    aspect-ratio: 16/9;
    background: #000;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 1rem;
    display: none; /* Hidden by default */
    position: relative;
  }
  #video-player {
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: #000;
  }
  
  /* Headings */
  main h2 {
    color: #ff66aa;
    margin-bottom: 0.8rem;
    font-weight: 700;
    user-select: none;
    border-left: 4px solid #ff3377;
    padding-left: 0.6rem;
  }

  /* Playlist */
  #playlist {
    list-style: none;
    padding: 0;
    margin: 0 0 1rem 0;
    max-height: 260px;
    overflow-y: auto;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    background: #222a44;
    -webkit-overflow-scrolling: touch;
  }
  #playlist li {
    padding: 0.7rem 1rem;
    border-bottom: 1px solid rgba(255,255,255,0.15);
    cursor: pointer;
    color: #ddd;
    display: grid;
    grid-template-columns: 30px 1fr 30px;
    gap: 0.5rem;
    align-items: center;
    transition: background 0.3s ease, color 0.3s ease;
    font-size: 0.92rem;
  }
  #playlist li:last-child {
    border-bottom: none;
  }
  #playlist li:hover {
    background: #ff3377;
    color: white;
  }
  #playlist li.playing {
    background: #ff66aa;
    color: #000;
    font-weight: 700;
  }
  #playlist li .track-number {
    font-weight: 700;
    text-align: center;
  }
  #playlist li .track-title {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  #playlist li .track-type {
    font-size: 0.7rem;
    background: rgba(255,255,255,0.2);
    padding: 2px 5px;
    border-radius: 4px;
    text-align: center;
  }

  /* Player controls */
  #player-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1.2rem;
    margin-bottom: 1rem;
  }
  button.control-btn {
    background: #ff3377;
    border: none;
    border-radius: 50%;
    width: 44px;
    height: 44px;
    color: white;
    font-size: 20px;
    font-weight: 700;
    line-height: 1;
    cursor: pointer;
    box-shadow: 0 4px 14px rgba(255,51,119,0.55);
    transition: background 0.25s ease;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  button.control-btn:active {
    background: #d1225b;
  }
  button.control-btn[disabled] {
    background: #666;
    cursor: not-allowed;
    box-shadow: none;
  }

  /* Progress bar */
  #progress-container {
    position: relative;
    width: 100%;
    height: 18px;
    background: #444c78;
    border-radius: 12px;
    overflow: hidden;
    cursor: pointer;
  }
  #progress {
    background: #ff66aa;
    height: 100%;
    width: 0%;
    transition: width 0.1s linear;
  }
  #time {
    margin-top: 6px;
    text-align: center;
    font-size: 0.85rem;
    color: #ffa0c9;
    font-variant-numeric: tabular-nums;
    user-select: none;
  }

  /* Footer */
  footer {
    margin-top: 1rem;
    font-size: 0.85rem;
    color: #ffa0c9;
    text-align: center;
    user-select: none;
  }

  /* Scrollbar styling for playlist */
  #playlist::-webkit-scrollbar {
    width: 6px;
  }
  #playlist::-webkit-scrollbar-track {
    background: #1c2640;
  }
  #playlist::-webkit-scrollbar-thumb {
    background: #ff3380;
    border-radius: 3px;
  }

  /* Responsive text sizes */
  @media (max-width: 400px) {
    header h1 {
      font-size: 1.3rem;
    }
    #playlist li {
      padding: 0.6rem 0.8rem;
      font-size: 0.88rem;
      grid-template-columns: 28px 1fr 28px;
    }
    button.control-btn {
      width: 36px;
      height: 36px;
      font-size: 18px;
    }
    #time {
      font-size: 0.75rem;
    }
  }

</style>
</head>
<body>
  <header>
    <h1>á€™á€¼á€”á€ºá€™á€¬á€· á€›á€±á€’á€®á€šá€­á€¯</h1>
    <p>Created by U Pannasiri(DBU)</p>
  </header>
  <main>
    <div id="video-container">
      <video id="video-player" playsinline></video>
    </div>
    
    <h2>Today's Playlist</h2>
    <ul id="playlist" aria-label="á€šá€”á€±á€·á á€á€®á€á€»á€„á€ºá€¸á€…á€¬á€›á€„á€ºá€¸"></ul>
    <div id="player-controls">
      <button id="prevBtn" class="control-btn" aria-label="á€¡á€›á€„á€º á€á€®á€á€»á€„á€ºá€¸">&#9664;&#9664;</button>
      <button id="playPauseBtn" class="control-btn" aria-label="á€–á€½á€„á€·á€ºá€›á€”á€º á€á€­á€¯á€·á€™á€Ÿá€¯á€á€º á€›á€•á€ºá€á€”á€·á€ºá€›á€”á€º">&#9658;</button>
      <button id="nextBtn" class="control-btn" aria-label="á€”á€±á€¬á€€á€º á€á€®á€á€»á€„á€ºá€¸">&#9654;&#9654;</button>
    </div>
    <div id="progress-container" aria-label="á€á€±á€¸á€™á€¼á€±á€•á€¯á€¶á€á€­á€¯á€¸á€á€»á€²á€·á€•á€™á€¬á€" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" tabindex="0">
      <div id="progress"></div>
    </div>
    <div id="time" aria-live="polite" aria-atomic="true">00:00 / 00:00</div>

    <h2>á€¡á€…á€®á€¡á€…á€‰á€º á€¡á€á€»á€­á€”á€ºá€‡á€šá€¬á€¸ (Program Schedule)</h2>
    <section id="program-schedule" style="color:#f0c4d9; font-size: 0.9rem; line-height:1.3; user-select:none;">
      <p><strong>á€”á€¶á€”á€€á€º á…á€¸á€á€ - áá‚á€¸á€á€</strong> - á€á€›á€¬á€¸á€á€±á€¬á€ºá€™á€»á€¬á€¸áŠ á€”á€±á€·á€…á€‰á€ºá€á€®á€á€»á€„á€ºá€¸á€™á€»á€¬á€¸á€”á€¾á€„á€·á€º á€—á€Ÿá€¯á€á€¯á€á€›á€±á€¸á€›á€¬á€¡á€–á€¼á€¬á€–á€¼á€¬</p>
      <p><strong>á€™á€½á€”á€ºá€¸á€œá€½á€² áá‚á€¸á€á€ - á‚á€¸á€á€</strong> - á€™á€¼á€”á€ºá€™á€¬á€á€®á€á€»á€„á€ºá€¸á€™á€»á€¬á€¸á€”á€¾á€„á€·á€º á€á€½á€±á€·á€†á€¯á€¶á€•á€½á€²á€™á€»á€¬á€¸</p>
      <p><strong>á€”á€±á€·á€œá€Šá€º á‚á€¸á€á€ - á„á€¸á€á€</strong> - á€¡á€™á€±á€¸á€¡á€–á€¼á€±á€™á€»á€¬á€¸á€”á€¾á€„á€·á€º á€¡á€„á€ºá€¹á€‚á€œá€­á€•á€ºá€á€®á€á€»á€„á€ºá€¸á€™á€»á€¬á€¸</p>
      <p><strong>á€Šá€”á€± á„á€¸á€á€ - á†á€¸á€á€</strong> - á€™á€¼á€”á€ºá€™á€¬á€á€¶á€…á€‰á€ºá€™á€»á€¬á€¸á€”á€¾á€„á€·á€º á€¡á€á€­á€•á€Šá€¬á€¡á€á€á€ºá€•á€Šá€¬á€™á€»á€¬á€¸á€†á€½á€±á€¸á€”á€½á€±á€¸ á€•á€¼á€±á€¬á€€á€¼á€¬á€¸á€á€¼á€„á€ºá€¸</p>
      <p><strong>á€Š á†á€¸á€á€ - ááá€¸á€á€</strong> - á€¡á€­á€•á€ºá€šá€¬á€á€„á€ºá€á€±á€¸á€á€¶á€…á€‰á€º á€‚á€®á€ á€”á€¾á€„á€·á€º á€¡á€œá€½á€™á€ºá€¸á€á€±á€¸á€™á€»á€¬á€¸</p>
    </section>
  </main>
  <footer>Â© 2024 FM AutoDJ Streaming Radio</footer>

  <script>
    (function(){
      // AutoDJ Playlist - Supports both MP3 and MP4
      const playlist = [
        {
          title: "á€“á€™á€¹á€™á€’á€°á€",
          artist: "á€¡á€„á€ºá€¹á€‚á€œá€­á€•á€ºá€¡á€†á€­á€¯á€á€±á€¬á€º",
          src: "http://www.upanna.com/dbu1.mp3",
          type: "audio"
        },
        {
          title: "á€™á€¼á€”á€ºá€™á€¬á€á€¶á€…á€‰á€ºá€á€®á€á€»á€„á€ºá€¸á€™á€»á€¬á€¸",
          artist: "á€á€±á€¸á€†á€­á€¯ - á€™á€”á€±á€¬á€”á€¾á€„á€·á€º á€¡á€†á€­á€¯á€á€±á€¬á€ºá€™á€»á€¬á€¸",
          src: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",
          type: "audio"
        },
        {
          title: "á€™á€¼á€”á€ºá€™á€¬á€›á€¯á€•á€ºá€›á€¾á€„á€ºá€á€®á€á€»á€„á€ºá€¸ (MP4)",
          artist: "á€¡á€†á€­á€¯á€á€±á€¬á€º - á€¡á€±á€¬á€„á€ºá€‘á€½á€”á€ºá€¸á€¦á€¸",
          src: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",
          type: "video"
        },
        {
          title: "á€™á€¼á€±á€–á€¼á€°á€œá€Šá€ºá€¸á€á€­á€¯ á€†á€›á€¬á€œá€Šá€ºá€¸á€¡á€­á€¯",
          artist: "á€á€±á€¸á€†á€­á€¯ - á€™á€»á€­á€¯á€¸á€€á€»á€±á€¬á€ºá€¦á€¸",
          src: "http://www.upanna.com/song4.mp3",
          type: "audio"
        }
      ];

      const playlistEl = document.getElementById('playlist');
      const playPauseBtn = document.getElementById('playPauseBtn');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const progressContainer = document.getElementById('progress-container');
      const progress = document.getElementById('progress');
      const timeEl = document.getElementById('time');
      const videoContainer = document.getElementById('video-container');
      const videoPlayer = document.getElementById('video-player');

      const audio = new Audio();
      let currentIndex = 0;
      let isPlaying = false;
      let currentMediaType = 'audio';

      // Build playlist UI with details
      function buildPlaylist() {
        playlist.forEach((track, i) => {
          const li = document.createElement('li');
          li.setAttribute('tabindex', '0');
          li.dataset.index = i;
          li.innerHTML =
            '<span class="track-number">' + (i + 1) + '</span>' +
            '<span class="track-title">' + track.title + '<br><small>' + track.artist + '</small></span>' +
            '<span class="track-type">' + (track.type === 'video' ? 'ğŸ¥' : 'ğŸµ') + '</span>';
          li.addEventListener('click', () => {
            loadTrack(i);
            playMedia();
          });
          li.addEventListener('keydown', (e) => {
            if(e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              loadTrack(i);
              playMedia();
            }
          });
          playlistEl.appendChild(li);
        });
      }

      function loadTrack(index) {
        if(index < 0) index = playlist.length - 1;
        else if(index >= playlist.length) index = 0;
        
        currentIndex = index;
        const track = playlist[index];
        currentMediaType = track.type;
        
        if(track.type === 'video') {
          // Hide audio player, show video player
          audio.pause();
          isPlaying = false;
          videoContainer.style.display = 'block';
          videoPlayer.src = track.src;
          videoPlayer.load();
          // iOS requires this for inline playback
          videoPlayer.setAttribute('playsinline', '');
          videoPlayer.setAttribute('webkit-playsinline', '');
        } else {
          // Hide video player, use audio player
          videoContainer.style.display = 'none';
          videoPlayer.pause();
          audio.src = track.src;
          audio.load();
        }
        
        updatePlaylistUI();
        updatePlayPauseButton();
        updateTime(0, 0);
        progress.style.width = '0%';
      }

      function playMedia() {
        if(currentMediaType === 'video') {
          // Important: On mobile, this must be triggered by user gesture
          const playPromise = videoPlayer.play();
          
          if (playPromise !== undefined) {
            playPromise.then(() => {
              isPlaying = true;
              updatePlayPauseButton();
              updatePlaylistUI();
            })
            .catch(error => {
              console.error("Video playback failed:", error);
              alert("á€—á€®á€’á€®á€šá€­á€¯á€–á€½á€„á€·á€ºá€›á€”á€º á€™á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€•á€«á‹ á€€á€»á€±á€¸á€‡á€°á€¸á€•á€¼á€¯á á€”á€±á€¬á€€á€ºá€á€…á€ºá€€á€¼á€­á€™á€ºá€€á€¼á€­á€¯á€¸á€…á€¬á€¸á€€á€¼á€Šá€·á€ºá€•á€«á‹\nError: " + error.message);
              // Fallback to showing controls if autoplay fails
              videoPlayer.setAttribute('controls', '');
            });
          }
        } else {
          audio.play()
            .then(() => {
              isPlaying = true;
              updatePlayPauseButton();
              updatePlaylistUI();
            })
            .catch(error => {
              console.error("Audio playback failed:", error);
              alert("á€á€®á€á€»á€„á€ºá€¸á€–á€½á€„á€·á€ºá€›á€”á€º á€™á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€•á€«á‹ á€€á€»á€±á€¸á€‡á€°á€¸á€•á€¼á€¯á á€”á€±á€¬á€€á€ºá€á€…á€ºá€€á€¼á€­á€™á€ºá€€á€¼á€­á€¯á€¸á€…á€¬á€¸á€€á€¼á€Šá€·á€ºá€•á€«á‹");
            });
        }
      }

      function pauseMedia() {
        if(currentMediaType === 'video') {
          videoPlayer.pause();
        } else {
          audio.pause();
        }
        isPlaying = false;
        updatePlayPauseButton();
      }

      function togglePlayPause() {
        if(isPlaying) pauseMedia();
        else playMedia();
      }

      function nextTrack() {
        loadTrack(currentIndex + 1);
        playMedia();
      }

      function prevTrack() {
        loadTrack(currentIndex - 1);
        playMedia();
      }

      function updatePlaylistUI() {
        const lis = playlistEl.querySelectorAll('li');
        lis.forEach(li => li.classList.remove('playing'));
        const currentLi = playlistEl.querySelector('li[data-index="'+currentIndex+'"]');
        if(currentLi) currentLi.classList.add('playing');
      }

      function updatePlayPauseButton() {
        playPauseBtn.innerHTML = isPlaying ? '&#10074;&#10074;' : '&#9658;';
      }

      function formatTime(seconds) {
        const m = Math.floor(seconds / 60);
        const s = Math.floor(seconds % 60);
        return (m < 10 ? '0'+m : m) + ':' + (s < 10 ? '0'+s : s);
      }

      function updateTime(current, duration) {
        timeEl.textContent = formatTime(current) + ' / ' + formatTime(duration);
      }

      // Audio event listeners
      audio.addEventListener('timeupdate', () => {
        if(audio.duration) {
          const percent = (audio.currentTime / audio.duration) * 100;
          progress.style.width = percent + '%';
          updateTime(audio.currentTime, audio.duration);
          progressContainer.setAttribute('aria-valuenow', Math.floor(percent));
        }
      });

      audio.addEventListener('ended', () => {
        nextTrack();
      });

      // Video event listeners
      videoPlayer.addEventListener('timeupdate', () => {
        if(!isNaN(videoPlayer.duration) {
          const percent = (videoPlayer.currentTime / videoPlayer.duration) * 100;
          progress.style.width = percent + '%';
          updateTime(videoPlayer.currentTime, videoPlayer.duration);
          progressContainer.setAttribute('aria-valuenow', Math.floor(percent));
        }
      });

      videoPlayer.addEventListener('ended', () => {
        nextTrack();
      });

      // Control event listeners
      playPauseBtn.addEventListener('click', togglePlayPause);
      prevBtn.addEventListener('click', prevTrack);
      nextBtn.addEventListener('click', nextTrack);

      progressContainer.addEventListener('click', (e) => {
        const rect = progressContainer.getBoundingClientRect();
        const clickX = e.clientX - rect.left;
        const width = rect.width;
        
        if(currentMediaType === 'video' && !isNaN(videoPlayer.duration)) {
          videoPlayer.currentTime = (clickX / width) * videoPlayer.duration;
        } else if(!isNaN(audio.duration)) {
          audio.currentTime = (clickX / width) * audio.duration;
        }
      });

      progressContainer.addEventListener('keydown', (e) => {
        let duration = currentMediaType === 'video' ? videoPlayer.duration : audio.duration;
        if(!isNaN(duration)){
          const step = duration * 0.05;
          if(e.key === 'ArrowLeft'){
            e.preventDefault();
            if(currentMediaType === 'video') {
              videoPlayer.currentTime = Math.max(0, videoPlayer.currentTime - step);
            } else {
              audio.currentTime = Math.max(0, audio.currentTime - step);
            }
          } else if(e.key === 'ArrowRight'){
            e.preventDefault();
            if(currentMediaType === 'video') {
              videoPlayer.currentTime = Math.min(duration, videoPlayer.currentTime + step);
            } else {
              audio.currentTime = Math.min(duration, audio.currentTime + step);
            }
          }
        }
      });

      // Error handling
      audio.addEventListener('error', function() {
        console.error("Audio error:", audio.error);
        alert("á€á€®á€á€»á€„á€ºá€¸á€–á€½á€„á€·á€ºá€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€á€…á€ºá€á€¯á€–á€¼á€…á€ºá€•á€±á€«á€ºá€”á€±á€•á€«á€á€Šá€ºá‹");
      });

      videoPlayer.addEventListener('error', function() {
        console.error("Video error:", videoPlayer.error);
        let message = "á€—á€®á€’á€®á€šá€­á€¯á€–á€½á€„á€·á€ºá€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€á€…á€ºá€á€¯á€–á€¼á€…á€ºá€•á€±á€«á€ºá€”á€±á€•á€«á€á€Šá€ºá‹";
        switch(videoPlayer.error.code) {
          case 1:
            message += "\n(á€™á€¾á€á€ºá€á€»á€€á€º: á€—á€®á€’á€®á€šá€­á€¯á€–á€­á€¯á€„á€ºá€€á€­á€¯ á€›á€¾á€¬á€™á€á€½á€±á€·á€•á€«)";
            break;
          case 2:
            message += "\n(á€™á€¾á€á€ºá€á€»á€€á€º: á€—á€®á€’á€®á€šá€­á€¯á€–á€­á€¯á€„á€ºá€¡á€™á€»á€­á€¯á€¸á€¡á€…á€¬á€¸ á€™á€™á€¾á€”á€ºá€•á€«)";
            break;
          case 3:
            message += "\n(á€™á€¾á€á€ºá€á€»á€€á€º: á€—á€®á€’á€®á€šá€­á€¯á€€á€­á€¯ á€’á€±á€«á€„á€ºá€¸á€œá€¯á€’á€ºá€†á€½á€²á€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€–á€¼á€…á€ºá€”á€±á€•á€«á€á€Šá€º)";
            break;
          case 4:
            message += "\n(á€™á€¾á€á€ºá€á€»á€€á€º: á€—á€®á€’á€®á€šá€­á€¯á€€á€­á€¯ á€–á€½á€„á€·á€ºáá€™á€›á€•á€«)";
            break;
        }
        alert(message);
        // Fallback to showing controls if error occurs
        videoPlayer.setAttribute('controls', '');
      });

      // Initialize
      buildPlaylist();
      loadTrack(0);
      
      // Auto-play first track after user interaction
      document.body.addEventListener('click', function initPlay() {
        playMedia();
        document.body.removeEventListener('click', initPlay);
      }, { once: true });
    })();
  </script>
</body>
</html>
